process PRODHLT  = {

    source = PoolSource{
        untracked vstring fileNames ={ 'file:$MYINPUTFILE' }
        untracked int32 maxEvents = -1
    }

 #   include "HLTrigger/Muon/data/PathSingleMu_2x1033_Iso.cff"
 #   path pSMIso = { singleMuIso }

 #   include "HLTrigger/Muon/data/PathSingleMu_2x1033_NoIso.cff"
 #   path pSMNoIso = { singleMuNoIso }

    include "HLTrigger/Muon/data/PathDiMuon_2x1033_Iso.cff"
    path pDMIso = { diMuonIso }

    include "HLTrigger/Muon/data/PathDiMuon_2x1033_NoIso.cff"
    path pDMNoIso = { diMuonNoIso }

    service = THistFileService { 
        string fileName = "$MYHISTOUTPUT"
    }

    module genparts = 
    genParticleCandidates from "PhysicsTools/HepMCCandAlgos/data/genParticleCandidates.cfi"

    PSet HistParams = {
         untracked double h_Pt_xmin        =    0
         untracked double h_Pt_xmax        =  100
         untracked int32  h_Pt_nbinsx      =  500
         untracked double hInvMass_xmin    =    0
         untracked double hInvMass_xmax    =   25
         untracked int32  hInvMass_nbinsx  = 1000
         untracked double h_InvMass_ymin   =    0
         untracked double h_InvMass_ymax   =   25
         untracked int32  h_InvMass_nbinsy = 1000
    }

    module mcinvmuonsmix = MCInvMassAna {
        InputTag src = genparts
        int32 pdgId1 = +13
        int32 pdgId2 = -13
        untracked double ptmin = 2.5
        untracked double etamax = 2.5
        using HistParams
    }

    module siminvmuonsmix = SimInvMassAna {
        InputTag src = g4SimHits
        int32 pdgId1 = +13
        int32 pdgId2 = -13
        untracked double ptmin = 2.5
        untracked double etamax = 2.5
        using HistParams
    }

    module InvhltMuonLevel1Seed = MuonHLTInvMassAna {
        InputTag src = hltMuonLevel1Seed
        using HistParams
    }

    module InvhltMuonLevel2Seed = MuonInvMassAna {
        InputTag src = L2MuonCandidates
        using HistParams
    }

    module InvhltMuonLevel3Seed = MuonInvMassAna {
        InputTag src = L3MuonCandidates
        using HistParams
    }

    module InvDiMuonNoIsoL1Filtered = MuonHLTInvMassAna {
        InputTag src = DiMuonNoIsoL1Filtered
        using HistParams
    }

    module InvDiMuonNoIsoL2PreFiltered = MuonHLTInvMassAna {
        InputTag src = DiMuonNoIsoL2PreFiltered
        using HistParams
    }

    module InvDiMuonNoIsoL3PreFiltered = MuonHLTInvMassAna {
        InputTag src = DiMuonNoIsoL3PreFiltered
        using HistParams
    }

    module InvDiMuonIsoL1Filtered = MuonHLTInvMassAna {
        InputTag src = DiMuonIsoL1Filtered
        using HistParams
    }

    module InvDiMuonIsoL2PreFiltered = MuonHLTInvMassAna {
        InputTag src = DiMuonIsoL2PreFiltered
        using HistParams
    }

    module InvDiMuonIsoL2IsoFiltered = MuonHLTInvMassAna {
        InputTag src = DiMuonIsoL2IsoFiltered
        using HistParams
    }

    module InvDiMuonIsoL3PreFiltered = MuonHLTInvMassAna {
        InputTag src = DiMuonIsoL3PreFiltered
        using HistParams
    }

    module InvDiMuonIsoL3IsoFiltered = MuonHLTInvMassAna {
        InputTag src = DiMuonIsoL3IsoFiltered
        using HistParams
    }

    path plotL1   = { l1muonreco & InvhltMuonLevel1Seed }
    path plotL2   = { l2muonreco & InvhltMuonLevel2Seed }
    path plotL3   = { l3muonreco & InvhltMuonLevel3Seed }

    path plotDM   = { DiMuonNoIsoL1Filtered    & InvDiMuonNoIsoL1Filtered & 
                      DiMuonNoIsoL2PreFiltered & InvDiMuonNoIsoL2PreFiltered & 
                      DiMuonNoIsoL3PreFiltered & InvDiMuonNoIsoL3PreFiltered }


    path plotDMI  = { DiMuonIsoL1Filtered    & InvDiMuonIsoL1Filtered &
                      DiMuonIsoL2PreFiltered & InvDiMuonIsoL2PreFiltered &
                      DiMuonIsoL2IsoFiltered & InvDiMuonIsoL2IsoFiltered &
                      DiMuonIsoL3PreFiltered & InvDiMuonIsoL3PreFiltered &
                      DiMuonIsoL3IsoFiltered & InvDiMuonIsoL3IsoFiltered }

    path plotGen  = { genparts , mcinvmuonsmix , siminvmuonsmix }

    module OUTPUT = PoolOutputModule {
        untracked string fileName ="$MYOUTPUTFILE" 

        untracked PSet SelectEvents = {
            vstring SelectEvents = { "pSMIso","pDMIso", "pSMNoIso", "pDMNoIso" }
        }

        untracked vstring outputCommands = {
            "drop *",
            "keep *_*_*_PRODHLT"
        }
    }

    service = Timing { }

#    endpath outpath = { OUTPUT }
}
